<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!-- Firebase v10 compat to stay consistent across pages -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
 
<script src="talabat.js" defer></script>
<link rel="stylesheet" href="header.css">
<link rel="stylesheet" href="loader.css">
<script src="loader.js" defer></script>
<script src="header.js" defer></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet" />


<style>
/* ==== Dark Mode for talabat page ==== */
body.dark-mode .content-container{
  background:#0f172a;
  color:#e6edf3;
  box-shadow:0 8px 22px rgba(0,0,0,0.35);
  border:1px solid #334155;
  border-radius:16px;
  padding:20px;
}

/* العنوان والأيقونة */
body.dark-mode .content-container h2{
  color:#7dd3fc;
}
body.dark-mode .content-container h2 i{
  color:#38bdf8;
}

/* قائمة الطلبات */
body.dark-mode .orders-list{
  background:#0b1220;
  border:1px solid #334155;
  color:#e6edf3;
  border-radius:14px;
  padding:12px;
}
body.dark-mode .orders-list::-webkit-scrollbar-track{ background:#0b1220; }
body.dark-mode .orders-list::-webkit-scrollbar-thumb{ background:#0ea5e9; }

/* الفوتر ومربعات الأيقونات */
body.dark-mode .footerContainer{
  background:linear-gradient(135deg,#0e7490,#083344);
  box-shadow:0 8px 18px rgba(0,0,0,0.35);
}
body.dark-mode .footer-title{
  color:#e6edf3;
}
body.dark-mode .icon-box{
  background:#0f172a;
  color:#e6edf3;
  box-shadow:0 6px 14px rgba(0,0,0,0.30);
  border:1px solid #334155;
}
body.dark-mode .icon-box i{ color:#7dd3fc; }
body.dark-mode .icon-box h3{ color:#e6edf3; }
body.dark-mode .icon-box p{ color:#cbd5e1; }


/* Dark mode style for order cards */
body.dark-mode .order-card {
  background: #1a2234;        /* خلفية داكنة */
  color: #e6edf3;             /* النصوص فاتحة */
  border: 1px solid #334155;  /* إطار أنعم */
}

body.dark-mode .order-card .order-header {
  background: #0f172a;        /* تمييز الهيدر داخل الكارد */
  color: #e6edf3;
}

body.dark-mode .order-card .order-status {
  color: #fbbf24;             /* أصفر للتأكيد */
}

body.dark-mode .order-card .order-details {
  background: #0b1220;
  color: #dbe2ea;
}

/* تحسين النصوص في تفاصيل الطلب للوضع الداكن */
body.dark-mode .order-card .order-details {
  background: #0b1220;
  color: #ffffff;              /* جعل النص أبيض واضح */
}

body.dark-mode .order-card .order-details p,
body.dark-mode .order-card .order-details li,
body.dark-mode .order-card .order-details strong,
body.dark-mode .order-card .order-details span {
  color: #ffffff !important;   /* ضمان أن كل النصوص تكون بيضاء */
}

body.dark-mode .order-card .order-details strong {
  color: #93c5fd !important;   /* تمييز النص الغامق بلون أزرق فاتح */
}

/* ===== شريط أدوات الطلبات (مثل المحفظة) ===== */
.toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:8px 0 12px}
.chip{padding:6px 10px;border-radius:999px;border:1px solid #e5e7eb;background:#fff;cursor:pointer;font-weight:700}
.chip.active{box-shadow:0 0 0 2px rgba(14,165,233,.15)}
.chip[data-filter="all"].active{background:#e5f3fb;border-color:#0ea5e9;color:#0b4a67}
.chip[data-filter="pending"]{background:#fff7ed;border-color:#fed7aa;color:#7c2d12}
.chip[data-filter="pending"].active{background:#fde7c7;border-color:#fb923c;color:#7c2d12}
.chip[data-filter="approved"]{background:#dcfce7;border-color:#86efac;color:#065f46}
.chip[data-filter="approved"].active{background:#bbf7d0;border-color:#22c55e;color:#065f46}
.chip[data-filter="rejected"]{background:#fee2e2;border-color:#fecaca;color:#7f1d1d}
.chip[data-filter="rejected"].active{background:#fecaca;border-color:#ef4444;color:#7f1d1d}
body.dark-mode .chip{background:#0f172a;border-color:#334155;color:#e6edf3}
body.dark-mode .chip[data-filter="all"].active{background:#0b2840;border-color:#0ea5e9;color:#7dd3fc}
body.dark-mode .chip[data-filter="pending"]{background:#2b2f3a;border-color:#a16207;color:#fde68a}
body.dark-mode .chip[data-filter="approved"]{background:#064e3b;border-color:#047857;color:#bbf7d0}
body.dark-mode .chip[data-filter="rejected"]{background:#3f1d1d;border-color:#7f1d1d;color:#fecaca}
/* Empty message styles */
#ordersEmptyMessage{
  padding:24px;
  text-align:center;
  border:1px dashed #e5e7eb;
  border-radius:12px;
  color:#6b7280;
  background:#fff;
  margin:12px 0;
  /* Center content nicely */
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  gap:8px;
  min-height:200px;
  /* Explicitly center in both axes in case of overrides */
  place-items:center;
  place-content:center;
}
body.dark-mode #ordersEmptyMessage{background:#0f172a;border-color:#334155;color:#9aa7b7}
/* Empty state illustration */
#ordersEmptyMessage .illu{display:block;margin:0 auto;align-self:center}
#ordersEmptyMessage .caption{font-size:14px}
body.dark-mode #ordersEmptyMessage .paper{fill:#1f2937}


/* الهواتف (شاشات أصغر من 480px) */
@media (max-width: 480px) {
  .content-container {
    margin: 20px 10px;
    padding: 15px;
  }

  .order-card {
    padding: 12px;
    font-size: 14px;
  }

  .order-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }

  .order-status {
    font-size: 13px;
    padding: 4px 10px;
  }

  .btn-show-proof {
    font-size: 14px;
    padding: 8px 12px;
  }

  .footer-icons {
    flex-direction: column;
    gap: 15px;
  }

  .icon-box {
    width: 100%;
    max-width: 250px;
  }
}

@media (max-width: 480px) {
  #sidebar ul li {
    padding: 18px 16px;
    font-size: 1rem;
  }
}

@media (max-width: 480px) {
  .footer-icons {
    flex-direction: column;
    align-items: center;
  }

  .icon-box {
    width: 90%;
    margin: 10px 0;
  }
}

@media (max-width: 480px) {
  .btn-show-proof {
    width: 100%;
    text-align: center;
  }
}

/* ======== Mobile Clean Patch (≤480px) ======== */
@media (max-width: 480px) {
  /* الهيدر غالبًا ثابت، وعندك body فيه padding-top مكرر 60/70px.
     ثبّتناه على 56px عشان مايبقاش فيه فراغ زائد. */
  body { padding-top: 56px !important; }

  /* الحاوية الرئيسية: عرض كامل، بدون ظل ثقيل */
  .content-container{
    max-width: none;
    width: 100%;
    margin: 56px 0 10px;
    padding: 8px;
    border: 0;
    border-radius: 0;
    background: transparent;
    box-shadow: none;
  }

  /* مساحة جانبية بسيطة للّست */
  #ordersContainer { padding: 0 8px; }

  /* الكرت: تبسيط تام + تباين واضح */
  .order-card{
    background: #0f172a;                 /* داكن نظيف */
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow: none;
    border-radius: 12px;
    padding: 0;                           /* الرأس يحمل الحشو */
    margin-bottom: 10px;
    transform: none;
  }
  .order-card::after{ display: none; }    /* إلغاء توهج الزاوية */

  /* رأس الكرت: منطقة ضغط كبيرة + شبكة مرتبة */
  .order-header{
    display: grid;
    grid-template-columns: 1fr auto 16px; /* معلومات | شارة | سهم */
    align-items: center;
    gap: 8px;
    padding: 12px;
    background: transparent;
  }
  .order-header > div:first-child{
    font-size: 14px;
    line-height: 1.5;
    color: #e6edf3;
  }
  .order-header i{                         /* السهم */
    font-size: 14px;
    margin: 0;
    transition: transform .2s ease;
  }
  /* تدوير السهم عند الفتح (سنضيف كلاس .open بالـ JS) */
  .order-card.open .order-header i { transform: rotate(180deg); }

  /* شارة الحالة كبادج صغيرة */
  .order-status{
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 999px;
    line-height: 1;
    white-space: nowrap;
  }

  /* تفاصيل الطلب: قراءة أسهل */
  .order-details{
    display: none;
    border-top: 1px solid rgba(255,255,255,0.06);
    background: #0b1220;
    padding: 12px;
    font-size: 13.5px;
    line-height: 1.6;
    border-radius: 0 0 12px 12px;
  }

  /* زر إثبات التحويل: عريض وواضح */
  .btn-show-proof{
    width: 100%;
    padding: 10px 12px;
    font-size: 14px;
  }

  /* سلوك أفضل لشاشات اللمس */
  @media (pointer: coarse) {
    .order-card:hover,
    .order-card:active { transform: none; box-shadow: none; }
  }
}

/* ======== Mobile Clean Patch (≤480px) ======== */
@media (max-width: 480px) {
  body { padding-top: 56px !important; }

  .content-container {
    max-width: none;
    width: 100%;
    margin: 56px 0 10px;
    padding: 8px;
    border: 0;
    border-radius: 0;
    box-shadow: none;
  }

  #ordersContainer { padding: 0 8px; }

  .order-card {
    border-radius: 12px;
    padding: 0;
    margin-bottom: 10px;
    transform: none;
    box-shadow: none;
  }
  .order-card::after { display: none; }

  .order-header {
    display: grid;
    grid-template-columns: 1fr auto 16px;
    align-items: center;
    gap: 8px;
    padding: 12px;
  }
  .order-header > div:first-child {
    font-size: 14px;
    line-height: 1.5;
  }
  .order-header i {
    font-size: 14px;
    transition: transform .2s ease;
  }
  .order-card.open .order-header i { transform: rotate(180deg); }

  .order-status {
    font-size: 12px;
    padding: 4px 10px;
    border-radius: 999px;
    line-height: 1;
    white-space: nowrap;
  }

  .order-details {
    display: none;
    padding: 12px;
    font-size: 13.5px;
    line-height: 1.6;
    border-radius: 0 0 12px 12px;
  }

  .btn-show-proof {
    width: 100%;
    padding: 10px 12px;
    font-size: 14px;
  }
}

/* ===== تخصيص ألوان الوضع الداكن ===== */
@media (max-width: 480px) {
  body.dark-mode .order-card {
    background: #0f172a;
    border: 1px solid rgba(255,255,255,0.08);
  }
  body.dark-mode .order-header > div:first-child { color: #e6edf3; }
  body.dark-mode .order-details {
    border-top: 1px solid rgba(255,255,255,0.06);
    background: #0b1220;
    color: #e6edf3;
  }

  /* الوضع الفاتح (عادي) */
  body:not(.dark-mode) .order-card {
    background: #ffffff;
    border: 1px solid #ddd;
  }
  body:not(.dark-mode) .order-header > div:first-child { color: #222; }
  body:not(.dark-mode) .order-details {
    border-top: 1px solid #eee;
    background: #fafafa;
    color: #333;
  }
}
/* ===== إصلاح اختفاء الخلفية في الوضع الفاتح ===== */

/* محتوى عام: خلي الحاوية بيضاء في الوضع الفاتح */
body:not(.dark-mode) .content-container{
  background: #ffffff;
  border: 1px solid #e8e8e8;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.04);
}



/* تضمن الظهور الصحيح على الشاشات الصغيرة أيضًا */
@media (max-width: 480px){
  body:not(.dark-mode) .content-container{
    background: #ffffff;          /* لا تخليها شفافة على الموبايل */
    border: 1px solid #e8e8e8;
    border-radius: 12px;
    margin: 56px 8px 10px;
    padding: 8px;
  }
  body:not(.dark-mode) .orders-list{
    background: #ffffff;
    border: 1px solid #e6e6e6;
    border-radius: 12px;
    padding: 8px;
  }
}
/* ===== لون الحالة في الوضع الداكن ===== */
body.dark-mode .order-status {
  color: #ffffff !important;   /* إجبار اللون أبيض */
}


/* Calendar popover */
.calendar-popover{position:fixed;inset:0;background:rgba(0,0,0,.35);display:flex;align-items:center;justify-content:center;z-index:1000}
.calendar-panel{background:#fff;color:#111;border:1px solid #e5e7eb;border-radius:12px;padding:14px;width:min(92vw,360px);box-shadow:0 10px 30px rgba(0,0,0,.15)}
.calendar-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.cal-nav{border:1px solid #e5e7eb;background:#fff;border-radius:8px;padding:4px 10px;cursor:pointer}
.cal-title{font-weight:800}
.calendar-sub{display:flex;align-items:center;justify-content:space-between;margin:6px 0 10px;font-size:.9rem}
.calendar-mode{display:flex;gap:6px}
.calendar-mode-btn{border:1px solid #e5e7eb;background:#fff;border-radius:8px;padding:4px 10px;cursor:pointer}
.calendar-mode-btn.active{background:#e5f3fb;border-color:#0ea5e9;color:#0b4a67}
.calendar-selection{color:#334155;font-weight:600;display:none}
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
.calendar-weekday{text-align:center;font-weight:700;font-size:.85rem;padding:6px 0;color:#64748b}
.calendar-spacer{height:1px}
.calendar-day{position:relative;text-align:center;padding:10px 0;border:1px solid #e5e7eb;border-radius:8px;cursor:pointer;background:#fff}
.calendar-day .num{position:relative;z-index:1;font-weight:700}
.calendar-day.has{background:#dcfce7;border-color:#86efac;color:#065f46}
.calendar-day.active{background:#e0f2fe;border-color:#93c5fd;outline:none}
.calendar-day.disabled{opacity:.5;cursor:not-allowed;pointer-events:none}
.calendar-day.in-range{background:#e0f2fe;border-color:#93c5fd}
.calendar-day.range-start,.calendar-day.range-end{background:#e0f2fe;border-color:#93c5fd;outline:none}
.calendar-day .count{position:absolute;top:-6px;inset-inline-end:-6px;background:#22c55e;color:#fff;border-radius:999px;min-width:18px;height:18px;line-height:18px;padding:0 6px;font-size:11px;box-shadow:0 2px 6px rgba(0,0,0,.15)}
body.dark-mode .calendar-panel{background:#0f172a;color:#e6edf3;border-color:#334155}
body.dark-mode .cal-nav{background:#0f172a;border-color:#334155;color:#e6edf3}
body.dark-mode .calendar-day{background:#0f172a;border-color:#334155}
body.dark-mode .calendar-day.has{background:#064e3b;border-color:#047857;color:#bbf7d0}
body.dark-mode .calendar-mode-btn{background:#0f172a;border-color:#334155;color:#e6edf3}
body.dark-mode .calendar-mode-btn.active{background:#0b2840;border-color:#0ea5e9;color:#7dd3fc}
body.dark-mode .calendar-day.in-range{background:#0b2840;border-color:#0ea5e9}
body.dark-mode .calendar-day.active{background:#0b2840;border-color:#0ea5e9;outline:none}
body.dark-mode .calendar-day.range-start, body.dark-mode .calendar-day.range-end{background:#0b2840;border-color:#0ea5e9;outline:none}

/* Mobile tuning */
@media (max-width: 420px){
  .calendar-panel{width:96vw;padding:10px;border-radius:10px}
  .calendar-header{margin-bottom:6px}
  .cal-nav{padding:4px 8px}
  .cal-title{font-size:14px}
  .calendar-sub{margin:4px 0 8px}
  .calendar-grid{gap:5px}
  .calendar-weekday{font-size:11px;padding:4px 0}
  .calendar-day{padding:8px 0;border-radius:10px}
  .calendar-day .num{font-size:13px}
  .calendar-day .count{min-width:16px;height:16px;line-height:16px;font-size:10px;top:-4px;inset-inline-end:-4px}
}
</style>


<title>طلباتي</title>
  <link rel="icon" href="https://i.ibb.co/zHC1tQ8b/1757362837638.png" type="image/png">
</head>
<body>
<div id="headerContainer"></div>
<div id="sidebarContainer"></div>
<div id="preloader">
  <div class="loader"></div>
</div>
<div id="ordersContainer"></div>
<div style="height: 50px;"></div>
<div id="footerContainer"></div>
<script>
  // 1) فعّل الثيم المحفوظ مبكرًا قدر الإمكان
  (function(){
    try{
      if(localStorage.getItem('theme') === 'dark'){
        document.body.classList.add('dark-mode');
      }
    }catch(e){}
  })();

  // 2) انتظر DOMContentLoaded لضمان جاهزية العناصر وملفات defer (مثل header.js)
  window.addEventListener('DOMContentLoaded', () => {
    // إنشاء الحاوية الرئيسية للمحتوى
    const contentContainer = document.createElement('div');
    contentContainer.className = 'content-container';

    // العنوان + الأيقونة
    const heading = document.createElement('h2');
    const icon = document.createElement('i');
    // Font Awesome v6
    icon.className = 'fa-solid fa-history';
    heading.appendChild(icon);
    heading.append(' طلباتي:');
    contentContainer.appendChild(heading);

    // شريط الأدوات: فلاتر الحالة + اختيار التاريخ
    const toolbar = document.createElement('div');
    toolbar.className = 'toolbar';
    toolbar.id = 'ordersToolbar';
    toolbar.innerHTML = `
      <button class="chip" data-filter="all">الكل</button>
      <button class="chip" data-filter="pending">قيد الانتظار</button>
      <button class="chip" data-filter="approved">تم الشحن</button>
      <button class="chip" data-filter="rejected">مرفوض</button>
      <span style="flex:1 1 auto"></span>
      <button class="chip" id="dateChip">التاريخ</button>
      <input type="date" id="ordersDatePicker" style="display:none" />
    `;
    contentContainer.appendChild(toolbar);

    // قائمة الطلبات
    const ordersList = document.createElement('div');
    ordersList.id = 'ordersList';
    ordersList.className = 'orders-list';
    contentContainer.appendChild(ordersList);

    // إدراج المحتوى في مكانه
    const container = document.getElementById('ordersContainer');
    if (container) {
      container.appendChild(contentContainer);
    } else {
      console.error('لم يتم العثور على العنصر بالمعرف "ordersContainer"');
    }

    // ====== بناء الفوتر ومربعات الأيقونات ======
    const footer = document.createElement('footer');
    footer.className = 'footerContainer';

    const footerTitle = document.createElement('h2');
    footerTitle.className = 'footer-title';
    footerTitle.textContent = 'لماذا تختارنا؟';
    footer.appendChild(footerTitle);

    // استخدم البيانات العالمية إن وُجدت وإلا افتراضي


    data.forEach(({ iconClass, title, desc }) => {
      const box = document.createElement('div');
      box.className = 'icon-box';

      const i = document.createElement('i');
      i.className = iconClass;
      box.appendChild(i);

      const h3 = document.createElement('h3');
      h3.textContent = title;
      box.appendChild(h3);

      const p = document.createElement('p');
      p.textContent = desc;
      box.appendChild(p);

      footer.appendChild(box);
    });

    const footerMount = document.getElementById('footerContainer');
    if (footerMount) {
      footerMount.appendChild(footer);
    }

    // ====== دوال مساعدة ======
    window.toggleOffer = function(el) {
      el.classList.toggle('selected');
    };

    window.showOrderDetails = function(orderCode) {
      const detailsEl = document.getElementById('orderDetails');
      if (!detailsEl) return; // تأكد من وجود العنصر

      if (orderCode) {
        detailsEl.style.display = 'block';
        detailsEl.innerHTML = '<p>تفاصيل الطلب لكود: <strong>' + orderCode + '</strong></p>';
      } else {
        detailsEl.style.display = 'none';
        detailsEl.innerHTML = '';
      }
    };
  });

function toggleDetails(code) {
  const d = document.getElementById(`details-${code}`);
  const card = document.getElementById(`order-${code}`);
  if (!d || !card) return;

  const isOpen = d.style.display === 'block';
  d.style.display = isOpen ? 'none' : 'block';
  card.classList.toggle('open', !isOpen);   // يضيف/يحذف كلاس للتحريك البصري
}




</script>

</body>
</html>

